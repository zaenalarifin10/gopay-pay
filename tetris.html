<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tetris Mobile</title>
<style>
  :root{
    --bg:#0f1720;
    --panel:#0b1220;
    --accent:#22c55e;
    --muted:#94a3b8;
  }
  html,body{height:100%;margin:0;background:var(--bg);font-family:Inter,system-ui,Arial;color:#e6eef6;touch-action:none}
  .wrap{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:14px;gap:12px;}
  canvas{background:#061021;border-radius:6px;box-shadow:0 4px 16px rgba(0,0,0,0.6)}
  .panel{background:var(--panel);padding:10px 14px;border-radius:8px;width:240px;text-align:center}
  .stat{display:flex;justify-content:space-between;margin:2px 0;font-weight:600;font-size:14px}
  #controls{display:grid;grid-template-columns:repeat(3,80px);gap:8px;margin-top:12px;justify-content:center}
  #controls button{font-size:18px;padding:10px;border:none;border-radius:8px;background:#1f2937;color:white;box-shadow:0 3px 8px rgba(0,0,0,0.3);cursor:pointer}
  #controls button:active{background:#374151}
  .footer{font-size:12px;color:var(--muted);margin-top:8px;text-align:center}
</style>
</head>
<body>
<div class="wrap">
  <canvas id="board" width="240" height="480"></canvas>
  <div class="panel">
    <div class="stat"><span>Score</span><span id="score">0</span></div>
    <div class="stat"><span>Level</span><span id="level">1</span></div>
    <div class="stat"><span>Lines</span><span id="lines">0</span></div>
  </div>

  <div id="controls">
    <button id="btnLeft">‚óÄÔ∏è</button>
    <button id="btnRotate">üîº</button>
    <button id="btnRight">‚ñ∂Ô∏è</button>
    <button id="btnDown">üîΩ</button>
    <button id="btnDrop">‚è¨</button>
    <button id="btnPause">‚è∏Ô∏è</button>
  </div>

  <div class="footer">Tetris versi mobile ‚Äî Sentuh tombol untuk bermain</div>
</div>

<script>
const COLS=10, ROWS=20, BLOCK=24;
const canvas=document.getElementById('board');
const ctx=canvas.getContext('2d');
let grid, current, nextPiece, gameOver=false, paused=false;
let dropCounter=0, dropInterval=1000, lastTime=0;
let score=0, level=1, totalLines=0;

const COLORS={I:'#00f0f0',J:'#0000f0',L:'#f0a000',O:'#f0f000',S:'#00f000',T:'#a000f0',Z:'#f00000'};
const PIECES={
  I:[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]]],
  J:[[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]]],
  L:[[[0,0,1],[1,1,1],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]]],
  O:[[[1,1],[1,1]]],
  S:[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]]],
  T:[[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]]],
  Z:[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]]]
};
function createGrid(){return Array.from({length:ROWS},()=>Array(COLS).fill(0));}
function randPiece(){const k=Object.keys(PIECES)[Math.floor(Math.random()*7)];return{type:k,rot:0,shape:PIECES[k][0],x:3,y:-1};}
function rotate(p){p.rot=(p.rot+1)%PIECES[p.type].length;p.shape=PIECES[p.type][p.rot];}
function collide(g,p){for(let r=0;r<p.shape.length;r++)for(let c=0;c<p.shape[r].length;c++)if(p.shape[r][c]){const x=p.x+c,y=p.y+r;if(x<0||x>=COLS||y>=ROWS||g[y]?.[x])return true;}return false;}
function merge(){for(let r=0;r<current.shape.length;r++)for(let c=0;c<current.shape[r].length;c++)if(current.shape[r][c]&&current.y+r>=0)grid[current.y+r][current.x+c]=current.type;}
function clearLines(){let lines=0;for(let y=ROWS-1;y>=0;y--)if(grid[y].every(v=>v)){grid.splice(y,1);grid.unshift(Array(COLS).fill(0));lines++;y++;}if(lines){const pts=[0,40,100,300,1200];score+=pts[lines]*level;totalLines+=lines;level=Math.floor(totalLines/10)+1;dropInterval=Math.max(1000-80*(level-1),100);updateHUD();}}
function newPiece(){current=nextPiece||randPiece();nextPiece=randPiece();if(collide(grid,current))gameOver=true;}
function updateHUD(){scoreEl.textContent=score;levelEl.textContent=level;linesEl.textContent=totalLines;}
function reset(){grid=createGrid();score=0;level=1;totalLines=0;dropInterval=1000;gameOver=false;paused=false;nextPiece=randPiece();newPiece();updateHUD();}
function draw(){ctx.clearRect(0,0,240,480);
for(let r=0;r<ROWS;r++)for(let c=0;c<COLS;c++){ctx.fillStyle=grid[r][c]?COLORS[grid[r][c]]:"#04111a";ctx.fillRect(c*BLOCK,r*BLOCK,BLOCK-1,BLOCK-1);}
if(current)for(let r=0;r<current.shape.length;r++)for(let c=0;c<current.shape[r].length;c++)if(current.shape[r][c]&&current.y+r>=0){ctx.fillStyle=COLORS[current.type];ctx.fillRect((current.x+c)*BLOCK,(current.y+r)*BLOCK,BLOCK-1,BLOCK-1);}
if(gameOver){ctx.fillStyle='rgba(0,0,0,0.6)';ctx.fillRect(0,0,240,480);ctx.fillStyle='#fff';ctx.font='bold 24px sans-serif';ctx.textAlign='center';ctx.fillText('GAME OVER',120,240);}
else if(paused){ctx.fillStyle='rgba(0,0,0,0.4)';ctx.fillRect(0,0,240,480);ctx.fillStyle='#fff';ctx.font='bold 20px sans-serif';ctx.textAlign='center';ctx.fillText('PAUSED',120,240);}
}
function drop(){current.y++;if(collide(grid,current)){current.y--;merge();clearLines();newPiece();}}
function loop(t=0){const delta=t-lastTime;lastTime=t;if(!paused&&!gameOver){dropCounter+=delta;if(dropCounter>dropInterval){drop();dropCounter=0;}}draw();requestAnimationFrame(loop);}
function move(dx){current.x+=dx;if(collide(grid,current))current.x-=dx;}
function rotateTry(){rotate(current);if(collide(grid,current))current.x<5?current.x++:current.x--;}
function hardDrop(){while(!collide(grid,current)){current.y++;score+=2;}current.y--;merge();clearLines();newPiece();updateHUD();}
function softDrop(){current.y++;if(collide(grid,current)){current.y--;merge();clearLines();newPiece();}else{score++;updateHUD();}}
const scoreEl=document.getElementById('score'),levelEl=document.getElementById('level'),linesEl=document.getElementById('lines');
document.getElementById('btnLeft').onclick=()=>move(-1);
document.getElementById('btnRight').onclick=()=>move(1);
document.getElementById('btnRotate').onclick=()=>rotateTry();
document.getElementById('btnDown').onclick=()=>softDrop();
document.getElementById('btnDrop').onclick=()=>hardDrop();
document.getElementById('btnPause').onclick=()=>{paused=!paused;};
document.addEventListener('keydown',e=>{
  if(e.key==='ArrowLeft')move(-1);
  else if(e.key==='ArrowRight')move(1);
  else if(e.key==='ArrowDown')softDrop();
  else if(e.key==='ArrowUp'||e.key.toLowerCase()==='x')rotateTry();
  else if(e.key===' ')hardDrop();
  else if(e.key.toLowerCase()==='p')paused=!paused;
});
reset();loop();
</script>
</body>
</html>
